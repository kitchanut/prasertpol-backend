(window.webpackJsonp=window.webpackJsonp||[]).push([[268],{1040:function(e,t,n){"use strict";n.r(t);var r=n(14),o=(n(56),n(39),n(480)),c=n(543),d=n(462),l={components:{dialogPathnerJobTechnician:n(584).default},data:function(){return{user_group_permission:this.$auth.$storage.getLocalStorage("userData-user_group_permission"),loading:!1,search:"",id:"",idWork:0,dialogPathnerJobTechnician:!1,formTitlePathnerJobTechnician:"Add",actionPathnerJobTechnician:"add",headers:[{text:"ลำดับ",value:"no",align:"center"},{text:"ชื่ออู่",value:"partner_technicians.partner_technician"},{text:"รายการซ่อม",value:"job_technician_pathner_list"},{text:"ราคาจริง",value:"job_price"},{text:"ซ่อมตอน",value:"typeRepair"},{text:"เสร็จวันที่",value:"expected_date_end"},{text:"โดย",value:"user.first_name"},{text:"จัดการ",value:"actions",sortable:!1,width:"10%"}],data:[],dataCar:[],car_id:""}},mounted:function(){this.getDataCar()},computed:{tHeader:function(){return this.headers.map((function(e){return e.text}))}},methods:{filterObject:function(e,t,n){return e.car_no.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1||e.car_regis.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1},getDataCar:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.l();case 2:return n=t.sent,t.next=5,n.data;case 5:e.dataCar=t.sent;case 6:case"end":return t.stop()}}),t)})))()},selectSee:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.data=[],e.loading=!0,t.next=4,c.c(e.car_id);case 4:return n=t.sent,t.next=7,n.data;case 7:e.data=t.sent,e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()},PathnerJobTechnician:function(e,t){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n.formTitlePathnerJobTechnician="edit"==t?"แจ้งซ่อม (อู่นอก)":"ปิดงาน (อู่นอก)",n.dialogPathnerJobTechnician=!0,n.id=e,n.actionPathnerJobTechnician=t;case 4:case"end":return r.stop()}}),r)})))()},addSuccess:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.dialogPathnerJobTechnician=!1,e.$nextTick((function(){e.selectSee(),d.k()}));case 2:case"end":return t.stop()}}),t)})))()},addError:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.dialogPathnerJobTechnician=!1,e.$nextTick((function(){e.selectSee(),d.j()}));case 2:case"end":return t.stop()}}),t)})))()},deleteItem:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=d.a(),n.next=3,o.then((function(n){1==n&&c.a(e).then(function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:200==n.status?d.k():d.j(),t.$nextTick((function(){t.selectSee()}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 3:case"end":return n.stop()}}),n)})))()}},watch:{data:function(){var e=this;return this.data.map((function(t){t.no=e.data.map((function(e){return e.id})).indexOf(t.id)+1}))}}},f=l,m=n(42),h=n(51),_=n.n(h),v=n(473),x=n(210),k=n(191),D=n(158),j=n(451),T=n(930),w=n(147),O=n(456),R=n(84),component=Object(m.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return-1==e.user_group_permission||9==e.user_group_permission||11==e.user_group_permission?n("div",[n("v-card",[n("v-card-title",[n("v-col",{attrs:{cols:"5"}},[n("v-autocomplete",{attrs:{filter:e.filterObject,"no-data-text":"ไม่มีข้อมูล",items:e.dataCar,"item-text":"car_no","item-value":"id",label:"ค้นหาตามลำดับรถ",outlined:"",dense:"","hide-details":""},on:{change:e.selectSee},scopedSlots:e._u([{key:"selection",fn:function(t){var n=t.item;return[e._v("\n              "+e._s(n.car_no)+" ("+e._s(n.car_regis)+")\n            ")]}},{key:"item",fn:function(t){var n=t.item;return[e._v("\n              "+e._s(n.car_no)+" ("+e._s(n.car_regis)+")\n            ")]}}],null,!1,2304979324),model:{value:e.car_id,callback:function(t){e.car_id=t},expression:"car_id"}})],1),e._v(" "),n("v-spacer"),e._v(" "),n("v-col",{attrs:{cols:"3"}},[n("v-text-field",{attrs:{id:"search",name:"search","append-icon":"mdi-magnify",label:"ค้นหา","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),e._v(" "),n("v-data-table",{attrs:{headers:e.headers,items:e.data,"items-per-page":10,search:e.search,loading:e.loading,"no-data-text":"ยังไม่มีการเพิ่มข้อมูล","loading-text":"กำลังโหลดข้อมูลกรุณารอสักครู่"},scopedSlots:e._u([{key:"item.job_technician_id",fn:function(t){var n=t.item;return[e._v("\n          "+e._s("J"+n.job_technician_id)+"\n        ")]}},{key:"item.created_at",fn:function(t){var n=t.item;return[e._v("\n          "+e._s(e.$moment(n.created_at).format("DD/MM/YYYY ( HH:mm น.)"))+"\n        ")]}},{key:"item.typeRepair",fn:function(t){var r=t.item;return[1==r.job_type?n("h5",{staticClass:"blue--text"},[e._v("ก่อนขาย")]):e._e(),e._v(" "),2==r.job_type?n("h5",{staticClass:"red--text"},[e._v("หลังขาย")]):e._e()]}},{key:"item.actions",fn:function(t){var r=t.item;return[n("v-btn",{attrs:{color:"primary",fab:"","x-small":"",dark:""},on:{click:function(t){return e.PathnerJobTechnician(r.id,"edit")}}},[n("v-icon",[e._v(" mdi-pencil ")])],1)]}}],null,!0)}),e._v(" "),n("dialogPathnerJobTechnician",{attrs:{dialogPathnerJobTechnician:e.dialogPathnerJobTechnician,id:e.id,work:e.id,idWork:e.idWork,actionPathnerJobTechnician:e.actionPathnerJobTechnician,formTitlePathnerJobTechnician:e.formTitlePathnerJobTechnician},on:{cancleItem:function(t){e.dialogPathnerJobTechnician=!1},success:e.addSuccess,error:e.addError}})],1)],1):e._e()}),[],!1,null,null,null);t.default=component.exports;_()(component,{VAutocomplete:v.a,VBtn:x.a,VCard:k.a,VCardTitle:D.c,VCol:j.a,VDataTable:T.a,VIcon:w.a,VSpacer:O.a,VTextField:R.a})},480:function(e,t,n){"use strict";n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"p",(function(){return d})),n.d(t,"q",(function(){return l})),n.d(t,"m",(function(){return f})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return h})),n.d(t,"b",(function(){return _})),n.d(t,"o",(function(){return v})),n.d(t,"s",(function(){return x})),n.d(t,"a",(function(){return k})),n.d(t,"c",(function(){return D})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return T})),n.d(t,"f",(function(){return w})),n.d(t,"n",(function(){return O})),n.d(t,"h",(function(){return R})),n.d(t,"j",(function(){return P})),n.d(t,"r",(function(){return J}));var r=n(459),path="/api/car";function o(){var e=r.a+path;return Object(r.b)("get",e,{})}function c(e){var t=r.a+path+"/"+e;return Object(r.b)("delete",t,{})}function d(e){var t=r.a+path;return Object(r.b)("post",t,e)}function l(e,t){var n=r.a+path+"/"+e;return Object(r.b)("put",n,t)}function f(e){var t=r.a+path+"/"+e;return Object(r.b)("get",t,{})}function m(){var e=r.a+"/api/SelectOnCarAll";return Object(r.b)("get",e,{})}function h(){var e=r.a+"/api/SelectAllCars";return Object(r.b)("get",e,{})}function _(){var e=r.a+"/api/SelectCarNo";return Object(r.b)("get",e,{})}function v(e){var t=r.a+"/api/StockOnCar";return Object(r.b)("post",t,e)}function x(e){var t=r.a+"/api/uploadImgCars";return Object(r.b)("post",t,e)}function k(e){var t=r.a+"/api/ImageCar/"+e;return Object(r.b)("post",t,{})}function D(e){var t=r.a+"/api/change_fist_img";return Object(r.b)("post",t,e)}function j(e){var t=r.a+"/api/deleteAllImgCar";return Object(r.b)("post",t,e)}function T(e){var t=r.a+"/api/deleteFolder";return Object(r.b)("post",t,e)}function w(e){var t=r.a+"/api/delete_img_car";return Object(r.b)("post",t,e)}function O(e){var t=r.a+"/api/showCar";return Object(r.b)("post",t,e)}function R(e,t){var n=r.a+"/api/getAllinfo/"+e+"/"+t;return Object(r.b)("get",n,{})}function P(e){var t=r.a+"/api/reRollCar/"+e;return Object(r.b)("get",t,{})}function J(){var e=r.a+"/api/update_amountPrice";return Object(r.b)("get",e,{})}},543:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m}));var r=n(459),path="/api/job_pathner_technician";function o(e){var t=r.a+path+"/"+e;return Object(r.b)("delete",t,{})}function c(e){var t=r.a+path;return Object(r.b)("post",t,e)}function d(e,t){var n=r.a+path+"/"+e;return Object(r.b)("put",n,t)}function l(e){var t=r.a+path+"/"+e;return Object(r.b)("get",t,{})}function f(e){var t=r.a+"/api/PathnerJobTechnicianWhere";return Object(r.b)("post",t,e)}function m(e){var t=r.a+"/api/JobTechnicianWhereCar_out/"+e;return Object(r.b)("post",t,{})}},584:function(e,t,n){"use strict";n.r(t);var r=n(14),o=(n(56),n(543)),c=n(538),d=n(602),l=n(130),f=n.n(l),m={components:{selectAddPartnerTechnician:d.default},props:["id","idWork","dialogPathnerJobTechnician","actionPathnerJobTechnician","idCar","jobType","formTitlePathnerJobTechnician"],data:function(){return{btnloading:!0,formDataLoading:!1,menuDateExpected_date_end:!1,formData:{},rule:[function(e){return!!e||"กรุณาใส่ข้อมูล"}],dialogDeleteComponent:!1,dataPartner_technician:[],isReadonly:!1,user_id:this.$auth.$storage.getLocalStorage("userData-id"),branch_id:this.$auth.$storage.getLocalStorage("userData-branch_id"),moment:f.a}},mounted:function(){},methods:{getPartner_technician:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.c();case 2:n=t.sent,e.dataPartner_technician=n.data;case 4:case"end":return t.stop()}}),t)})))()},addSuccess:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getPartner_technician();case 2:case"end":return e.stop()}}),e)})))()},addError:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getPartner_technician();case 2:case"end":return e.stop()}}),e)})))()},onAction:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.$refs.form.validate()){n.next=19;break}if(t.btnloading=!0,t.formDataLoading=!0,"add"!=t.actionPathnerJobTechnician){n.next=11;break}return n.next=6,o.e(t.formData);case 6:r=n.sent,t.$refs.form.reset(),200==r.status?t.$emit("success","Job_pathner"):t.$emit("error","Job_pathner"),n.next=17;break;case 11:if("edit"!=t.actionPathnerJobTechnician&&"endJob"!=t.actionPathnerJobTechnician){n.next=17;break}return n.next=14,o.f(e,t.formData);case 14:c=n.sent,t.$refs.form.reset(),200==c.status?t.$emit("success","Job_pathner"):t.$emit("error","Job_pathner");case 17:t.btnloading=!1,t.formDataLoading=!1;case 19:case"end":return n.stop()}}),n)})))()}},watch:{dialogPathnerJobTechnician:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.dialogDeleteComponent=e.dialogPathnerJobTechnician,!e.dialogPathnerJobTechnician){t.next=26;break}if(e.getPartner_technician(),"add"!=e.actionPathnerJobTechnician){t.next=8;break}e.isReadonly=!1,e.$nextTick((function(){e.$refs.form.reset();var t=e;e.$nextTick(Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.formData.car_id=e.idCar,t.formData.user_id=e.user_id,t.formData.branch_id=e.branch_id,t.formData.job_type=e.jobType,t.formData.working_id=e.idWork,t.formData.job_technician_pathner_list="กันชนหน้า, ฝากระโปรงหน้า,  แก้มหน้า L, กระจกมองข้าง L,  กระจกมองข้าง R, ประตูหน้า L,  ประตูหน้า R, ประตูหลัง L, ประตูหลัง R,ประตูหลัง R, แคป L, แคป R, บังโคลนหลัง R, บังโคลนหลัง L, แผงหลังเก๋ง, กระบะ L, กระบะ R, ฝาท้าย, ฝากระโปรงหลัง, กันชนหลัง, บังโคลนหน้า R, บังโคลนหน้า L, หลังคา, คานรับกันชนหน้า, ฐานรองแบต,ก้านปัดน้ำฝน,ขัดสี";case 6:case"end":return n.stop()}}),n)}))))})),t.next=26;break;case 8:if("edit"!=e.actionPathnerJobTechnician){t.next=18;break}return e.isReadonly=!1,e.formDataLoading=!0,t.next=13,o.d(e.id);case 13:n=t.sent,e.$nextTick((function(){e.$refs.form.reset();var t=e;e.$nextTick(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.data;case 2:t.formData=e.sent;case 3:case"end":return e.stop()}}),e)}))))})),e.formDataLoading=!1,t.next=26;break;case 18:if("endJob"!=e.actionPathnerJobTechnician){t.next=26;break}return e.isReadonly=!0,e.formDataLoading=!0,t.next=23,o.d(e.id);case 23:c=t.sent,e.$nextTick((function(){e.$refs.form.reset();var t=e;e.$nextTick(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.data;case 2:t.formData=e.sent,t.formData.date_end=f()().format("YYYY-MM-DD HH:mm:ss"),t.formData.job_status=2;case 5:case"end":return e.stop()}}),e)}))))})),e.formDataLoading=!1;case 26:e.btnloading=!1;case 27:case"end":return t.stop()}}),t)})))()},dialogDeleteComponent:function(){this.dialogDeleteComponent||this.$emit("cancleItem")}}},h=n(42),_=n(51),v=n.n(_),x=n(473),k=n(210),D=n(191),j=n(158),T=n(451),w=n(458),O=n(929),R=n(452),P=n(482),J=n(200),C=n(192),$=n(455),y=n(456),L=n(84),V=n(518),S=n(50),component=Object(h.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-dialog",{attrs:{"max-width":"50%"},model:{value:e.dialogDeleteComponent,callback:function(t){e.dialogDeleteComponent=t},expression:"dialogDeleteComponent"}},[n("v-card",[n("v-form",{ref:"form",attrs:{autocomplete:"true",readonly:e.isReadonly},on:{submit:function(t){return t.preventDefault(),e.onAction(e.formData.id)}}},[n("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[e._v("\n          "+e._s(e.formTitlePathnerJobTechnician)+"\n        ")]),e._v(" "),e.formDataLoading?n("v-progress-linear",{attrs:{indeterminate:"",color:"yellow darken-2"}}):e._e(),e._v(" "),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-autocomplete",{attrs:{id:"formData.partner_technician_id",name:"formData.partner_technician_id",items:e.dataPartner_technician,"item-text":"partner_technician","no-data-text":"ไม่มีข้อมูล","item-value":"id",label:"มอบงานให้อู่",outlined:"",dense:"","hide-details":"",rules:e.rule},scopedSlots:e._u([{key:"append-item",fn:function(){return[n("selectAddPartnerTechnician",{on:{success:e.addSuccess,error:e.addError}})]},proxy:!0}]),model:{value:e.formData.partner_technician_id,callback:function(t){e.$set(e.formData,"partner_technician_id",t)},expression:"formData.partner_technician_id"}})],1),e._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-menu",{ref:"menuDateExpected_date_end",attrs:{disabled:e.isReadonly,id:"menuDateExpected_date_end",name:"menuDateExpected_date_end","close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,o=t.attrs;return[n("v-text-field",e._g(e._b({attrs:{autocomplete:"true",id:"formData.expected_date_end",name:"formData.expected_date_end",label:"คาดว่าจะเสร็จวันที่","persistent-hint":"","prepend-icon":"",outlined:"",dense:"",clearable:"","hide-details":"","flathide-details":"",rules:e.rule},model:{value:e.formData.expected_date_end,callback:function(t){e.$set(e.formData,"expected_date_end",t)},expression:"formData.expected_date_end"}},"v-text-field",o,!1),r))]}}]),model:{value:e.menuDateExpected_date_end,callback:function(t){e.menuDateExpected_date_end=t},expression:"menuDateExpected_date_end"}},[e._v(" "),n("v-date-picker",{attrs:{id:"formData.expected_date_end",name:"formData.expected_date_end",locale:"th-TH","picker-date":""},on:{input:function(t){e.menuDateExpected_date_end=!1}},model:{value:e.formData.expected_date_end,callback:function(t){e.$set(e.formData,"expected_date_end",t)},expression:"formData.expected_date_end"}})],1)],1)],1),e._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{autocomplete:"true",label:"จำนวนเงิน","append-icon":"",type:"number",min:"0",id:"formData.job_price",name:"formData.job_price",outlined:"",dense:"","hide-details":""},model:{value:e.formData.job_price,callback:function(t){e.$set(e.formData,"job_price",t)},expression:"formData.job_price"}})],1)],1),e._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{rows:"4",label:"รายการที่ต้องทำ","append-icon":"",id:"formData.job_technician_pathner_list",name:"formData.job_technician_pathner_list",outlined:"",dense:"","hide-details":"",rules:e.rule},model:{value:e.formData.job_technician_pathner_list,callback:function(t){e.$set(e.formData,"job_technician_pathner_list",t)},expression:"formData.job_technician_pathner_list"}})],1)],1)],1)],1),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(t){return e.$emit("cancleItem")}}},[e._v("ยกเลิก")]),e._v(" "),n("v-btn",{attrs:{type:"submit",color:"success darken-1",text:"",loading:e.btnloading}},[e._v("บันทึก")])],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;v()(component,{VAutocomplete:x.a,VBtn:k.a,VCard:D.a,VCardActions:j.a,VCardText:j.b,VCol:T.a,VContainer:w.a,VDatePicker:O.a,VDialog:R.a,VForm:P.a,VMenu:J.a,VProgressLinear:C.a,VRow:$.a,VSpacer:y.a,VTextField:L.a,VTextarea:V.a,VToolbar:S.a})}}]);