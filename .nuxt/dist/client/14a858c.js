(window.webpackJsonp=window.webpackJsonp||[]).push([[274,104],{1046:function(e,t,r){"use strict";r.r(t);var n=r(14),o=(r(56),r(39),r(510)),c=r(462),l=r(919),d=r(497),m={components:{dialogNew:l.default,dialogImage:d.default},data:function(){return{serverUrl:"https://www.psnkp.co.th/server",loading:!0,search:"",dialog:!1,id:"",formTitle:"Add",action:"add",imgUrl:"",dialogImg:!1,user_group_permission:this.$auth.$storage.getLocalStorage("userData-user_group_permission"),branch_id:this.$auth.$storage.getLocalStorage("userData-branch_id"),headers:[{text:"รูปภาพ",value:"user_image"},{text:"ชื่อ นามสกุล",value:"full_name"},{text:"ตำแหน่ง",value:"user_group.user_group_name"},{text:"สังกัด",value:"branch.branch_name"},{text:"ทีม",value:"team.team_name",width:"10%"},{text:"เบอร์",value:"tel"},{text:"ตำแหน่ง (จำนวน)",value:"user_sub_groups"},{text:"สถานะ",value:"user_active",width:"5%"},{text:"จัดการ",value:"actions",sortable:!1,width:"10%"}],tbl_users:[]}},mounted:function(){this.getdata()},computed:{tHeader:function(){return this.headers.map((function(e){return e.text}))}},methods:{showImg:function(e){this.dialogImg=!0,this.imgUrl=e},getdata:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,c,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.b();case 2:if(r=t.sent,2==e.user_group_permission)if(1==e.branch_id){for(n=[],c=0;c<r.data.length;c++)3==r.data[c].user_group_id&&r.data[c].branch_id==e.branch_id&&n.push(r.data[c]);e.tbl_users=n}else{for(l=[],d=0;d<r.data.length;d++)e.branch_id==r.data[d].branch_id&&l.push(r.data[d]);e.tbl_users=l}else e.tbl_users=r.data;e.loading=!1;case 5:case"end":return t.stop()}}),t)})))()},AddItem:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.formTitle="เพิ่มข้อมูล",e.dialog=!0,e.id="",e.action="add";case 4:case"end":return t.stop()}}),t)})))()},editItem:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.formTitle="แก้ไขข้อมูล",t.dialog=!0,t.id=e,t.action="edit";case 4:case"end":return r.stop()}}),r)})))()},deleteItem:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return l=c.a(),r.next=3,l.then((function(r){1==r&&o.a(e).then(function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:200==r.status?c.k():c.j(),t.$nextTick((function(){t.getdata()}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 3:case"end":return r.stop()}}),r)})))()},addSuccess:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.dialog=!1,e.$nextTick((function(){e.getdata(),c.k()}));case 2:case"end":return t.stop()}}),t)})))()},addError:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.dialog=!1,e.$nextTick((function(){e.getdata(),c.j()}));case 2:case"end":return t.stop()}}),t)})))()}},watch:{tbl_users:function(){return this.tbl_users.map((function(e,t){e.full_name=e.first_name+" "+e.last_name}))}}},f=m,v=r(42),h=r(51),_=r.n(h),x=r(196),w=r(210),k=r(191),I=r(158),R=r(451),V=r(930),j=r(147),C=r(156),D=r(456),T=r(84),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-card",[r("v-card-title",[[r("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(t){return t.stopPropagation(),e.AddItem()}}},[r("v-icon",{attrs:{left:""}},[e._v("mdi-plus")]),e._v("\n          เพิ่มรายการใหม่\n        ")],1)],e._v(" "),r("v-spacer"),e._v(" "),r("v-col",{attrs:{cols:"3"}},[r("v-text-field",{attrs:{id:"search",name:"search","append-icon":"mdi-magnify",label:"ค้นหา","single-line":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2),e._v(" "),r("v-data-table",{attrs:{headers:e.headers,items:e.tbl_users,"items-per-page":10,search:e.search,loading:e.loading,"no-data-text":"ยังไม่มีการเพิ่มข้อมูล","loading-text":"กำลังโหลดข้อมูลกรุณารอสักครู่"},scopedSlots:e._u([{key:"item.user_image",fn:function(t){var n=t.item;return[r("v-btn",{attrs:{icon:""}},[r("v-avatar",{attrs:{size:"40"},on:{click:function(t){return e.showImg(e.serverUrl+n.user_image)}}},[r("v-img",{attrs:{src:e.serverUrl+n.user_image}})],1)],1)]}},{key:"item.user_active",fn:function(t){return[1==t.item.user_active?r("v-btn",{attrs:{"x-small":"",color:"success",dark:""}},[e._v("เปิดใช้งาน")]):r("v-btn",{attrs:{"x-small":"",color:"red",dark:""}},[e._v("ปิดการใช้งาน")])]}},{key:"item.actions",fn:function(t){var n=t.item;return[r("v-btn",{attrs:{color:"primary",fab:"","x-small":"",dark:""},on:{click:function(t){return e.editItem(n.id)}}},[r("v-icon",[e._v(" mdi-pencil ")])],1),e._v(" "),r("v-btn",{attrs:{color:"red",fab:"","x-small":"",dark:""},on:{click:function(t){return e.deleteItem(n.id)}}},[r("v-icon",[e._v(" mdi-delete ")])],1)]}}],null,!0)}),e._v(" "),r("dialogNew",{attrs:{dialog:e.dialog,id:e.id,action:e.action,formTitle:e.formTitle},on:{cancleItem:function(t){e.dialog=!1},success:function(t){return e.addSuccess()},error:function(t){return e.addError()}}}),e._v(" "),r("dialogImage",{attrs:{dialog:e.dialogImg,imgUrl:e.imgUrl},on:{cancleItem:function(t){e.dialogImg=!1}}})],1)],1)}),[],!1,null,null,null);t.default=component.exports;_()(component,{VAvatar:x.a,VBtn:w.a,VCard:k.a,VCardTitle:I.c,VCol:R.a,VDataTable:V.a,VIcon:j.a,VImg:C.a,VSpacer:D.a,VTextField:T.a})},497:function(e,t,r){"use strict";r.r(t);var n=r(14),o=(r(56),{props:["dialog","imgUrl"],data:function(){return{dialogDeleteComponent:!1}},mounted:function(){},methods:{},watch:{dialog:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.dialogDeleteComponent=e.dialog;case 1:case"end":return t.stop()}}),t)})))()},dialogDeleteComponent:function(){this.dialogDeleteComponent||this.$emit("cancleItem")}}}),c=r(42),l=r(51),d=r.n(l),m=r(191),f=r(458),v=r(452),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-dialog",{attrs:{width:"600px"},model:{value:e.dialogDeleteComponent,callback:function(t){e.dialogDeleteComponent=t},expression:"dialogDeleteComponent"}},[r("v-card",[r("img",{attrs:{width:"600px",height:"auto",src:e.imgUrl}})])],1)],1)}),[],!1,null,null,null);t.default=component.exports;d()(component,{VCard:m.a,VContainer:f.a,VDialog:v.a})}}]);